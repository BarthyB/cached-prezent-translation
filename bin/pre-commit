#!/bin/bash

echo -e "[EXECUTING PRE COMMIT HOOK]\n"

DIRECTORIES="lib tests"

echo -e "Removing VarDump uses\n"
if [[ "$OSTYPE" == "darwin"* ]]; then
  # shellcheck disable=SC2086
  find $DIRECTORIES -type f -name '*.php' -exec sed -i '' '/VarDumper/d' {} \;
else
  # shellcheck disable=SC2086
  find $DIRECTORIES -type f -name '*.php' -exec sed -i '/VarDumper/d' {} \;
fi

echo -e "Fixing PHP Code Style\n"
# shellcheck disable=SC2086
vendor/bin/php-cs-fixer fix $DIRECTORIES --config=.php_cs

echo -e "Staging Changes\n"
git update-index --again
